# 国策树预览与编辑

HOI4 Code Studio 提供了强大的国策树可视化预览与编辑功能，让国策树的设计变得直观且高效。

## 开启方式

当在编辑器中打开一个国策定义文件（通常位于 `common/national_focus` 目录下）时，编辑区右上角会出现 **"预览国策树"** 按钮。点击该按钮即可在右侧（或当前）分割窗格中打开可视化视图。

## 视图交互

### 基础操作
- **缩放**：使用鼠标滚轮放大或缩小视图。
- **平移**：按住鼠标左键或中键拖拽画布，移动视野。
- **复位**：点击视图工具栏的复位按钮，可以将视图恢复到默认缩放和中心位置。

### 节点交互
- **跳转代码**：单击任意国策节点，左侧代码编辑器会自动跳转到该国策的定义行。
- **悬停信息**：鼠标悬停在节点上，会显示该国策的完整 ID 和其他简要信息。
- **高亮关联**：选中一个节点时，其前置条件（Prerequisite）和互斥国策（Mutually Exclusive）的连线会高亮显示，方便理清关系。
  - **蓝色实线**：必要前置条件 (AND)。
  - **蓝色虚线**：可选前置条件 (OR)。
  - **红色虚线**：互斥关系。

## 可视化编辑

除了查看，该视图还支持直接修改国策树结构，修改结果会实时同步回代码文件。

### 拖拽布局
- 按住节点并拖动，可以直接改变国策的 `x` 和 `y` 坐标。
- 释放鼠标后，代码中的坐标值会自动更新。
- **提示**：配合网格辅助线，可以轻松对齐节点。

### 新建国策
1. 在画布空白处点击 **右键**。
2. 选择 **"新建国策"**。
3. 在弹出的对话框中填写：
   - **ID**：国策的唯一标识符。
   - **坐标**：默认填充为点击位置的坐标。
   - **花费**：完成国策所需的时间（默认 10）。
   - **前置条件**：可选，输入前置国策的 ID。
4. 点击确认，系统会自动在文件末尾生成对应的代码块，并在视图中显示新节点。

### 编辑国策
1. 在现有国策节点上点击 **右键**。
2. 选择 **"编辑国策"**（如果支持）。
3. 可以修改 ID、坐标等基本属性。

## 搜索与定位

视图顶部提供了搜索框：
- 输入国策 ID 的关键词。
- 所有匹配的节点会高亮显示（红色边框）。
- 视图会自动平移并缩放到第一个匹配的节点位置。
